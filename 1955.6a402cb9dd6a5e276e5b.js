"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1955],{1955:function(e,a,n){n.r(a),n(7378);var t=n(2682),p=["components"];function o(){return o=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},o.apply(this,arguments)}function s(e){var a=e.components,n=function(e,a){if(null==e)return{};var n,t,p=function(e,a){if(null==e)return{};var n,t,p={},o=Object.keys(e);for(t=0;t<o.length;t++)n=o[t],a.indexOf(n)>=0||(p[n]=e[n]);return p}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)n=o[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(p[n]=e[n])}return p}(e,p);return(0,t.kt)("wrapper",o({components:a},n),(0,t.kt)("p",null,"想要消除 ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack.config.js")," 在 ",(0,t.kt)("a",{href:"/guides/development",parentName:"p"},"开发环境")," 和 ",(0,t.kt)("a",{href:"/guides/production",parentName:"p"},"生产环境")," 之间的差异，你可能需要环境变量(environment variable)。"),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"提示"),(0,t.kt)("p",{parentName:"aside"},"webpack 环境变量，与操作系统中的 ",(0,t.kt)("inlineCode",{parentName:"p"},"bash")," 和 ",(0,t.kt)("inlineCode",{parentName:"p"},"CMD.exe")," 这些 shell ",(0,t.kt)("a",{href:"https://en.wikipedia.org/wiki/Environment_variable",parentName:"p"},"环境变量")," 不同。")),(0,t.kt)("p",null,"webpack 命令行 ",(0,t.kt)("a",{href:"/api/cli/#environment-options",parentName:"p"},"环境配置")," 的 ",(0,t.kt)("inlineCode",{parentName:"p"},"--env")," 参数，可以允许你传入任意数量的环境变量。而在 ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack.config.js")," 中可以访问到这些环境变量。例如，",(0,t.kt)("inlineCode",{parentName:"p"},"--env production")," 或 ",(0,t.kt)("inlineCode",{parentName:"p"},"--env goal=local"),"。"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-bash",parentName:"pre"},"npx webpack --env ",(0,t.kt)("span",{className:"token assign-left variable",parentName:"code"},"goal"),(0,t.kt)("span",{className:"token operator",parentName:"code"},"="),"local --env production --progress")),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"提示"),(0,t.kt)("p",{parentName:"aside"},"如果设置 ",(0,t.kt)("inlineCode",{parentName:"p"},"env")," 变量，却没有赋值，",(0,t.kt)("inlineCode",{parentName:"p"},"--env production")," 默认表示将 ",(0,t.kt)("inlineCode",{parentName:"p"},"env.production")," 设置为 ",(0,t.kt)("inlineCode",{parentName:"p"},"true"),"。还有许多其他可以使用的语法。更多详细信息，请查看 ",(0,t.kt)("a",{href:"/api/cli/#environment-options",parentName:"p"},"webpack CLI")," 文档。")),(0,t.kt)("p",null,"对于我们的 webpack 配置，有一个必须要修改之处。通常，",(0,t.kt)("inlineCode",{parentName:"p"},"module.exports")," 指向配置对象。要使用 ",(0,t.kt)("inlineCode",{parentName:"p"},"env")," 变量，你必须将 ",(0,t.kt)("inlineCode",{parentName:"p"},"module.exports")," 转换成一个函数："),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"webpack.config.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," path ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'path'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\nmodule",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function-variable function",parentName:"code"},"exports")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"env"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// Use env.<YOUR VARIABLE> here:"),"\n  console",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"log"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'Goal: '"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," env",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"goal",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";")," ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// 'local'"),"\n  console",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"log"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'Production: '"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," env",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"production",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";")," ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// true"),"\n\n  ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    entry",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'./src/index.js'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    output",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      filename",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'bundle.js'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      path",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," path",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"resolve"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"__dirname",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'dist'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"提示"),(0,t.kt)("p",{parentName:"aside"},"webpack CLI 提供一些你可以在 webpack 配置中访问的",(0,t.kt)("a",{href:"/api/cli/#cli-environment-variables",parentName:"p"},"内建环境变量"),"。")))}s.isMDXComponent=!0,a.default=s}}]);