"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[783],{783:function(a,e,n){n.r(e),n(7378);var t=n(2682),s=["components"];function p(){return p=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(a[t]=n[t])}return a},p.apply(this,arguments)}function o(a){var e=a.components,n=function(a,e){if(null==a)return{};var n,t,s=function(a,e){if(null==a)return{};var n,t,s={},p=Object.keys(a);for(t=0;t<p.length;t++)n=p[t],e.indexOf(n)>=0||(s[n]=a[n]);return s}(a,e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(a);for(t=0;t<p.length;t++)n=p[t],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(a,n)&&(s[n]=a[n])}return s}(a,s);return(0,t.kt)("wrapper",p({components:e},n),(0,t.kt)("p",null,"除了打包应用程序，webpack 还可以打包 JavaScript 库。以下指南适用于希望简化打包策略的库作者。"),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"authoring-a-library",parentName:"h2"}),"创建一个库",(0,t.kt)("a",{href:"#authoring-a-library","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"假设正在编写一个名为 ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack-numbers")," 的库，用于将数字 1 到 5 转换为文本表示，反之亦然，例如将 2 转换为 'two'。"),(0,t.kt)("p",null,"基本的项目结构应该与下面类似："),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"project")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-diff",parentName:"pre"},(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  |- webpack.config.js\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  |- package.json\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  |- /src\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    |- index.js\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    |- ref.json")))),(0,t.kt)("p",null,"使用 npm 初始化项目，然后安装 ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack"),"、",(0,t.kt)("inlineCode",{parentName:"p"},"webpack-cli")," 与 ",(0,t.kt)("inlineCode",{parentName:"p"},"lodash"),"："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-bash",parentName:"pre"},(0,t.kt)("span",{className:"token function",parentName:"code"},"npm")," init -y\n",(0,t.kt)("span",{className:"token function",parentName:"code"},"npm")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"install")," --save-dev webpack webpack-cli lodash")),(0,t.kt)("p",null,"注意：由于不需要将 ",(0,t.kt)("inlineCode",{parentName:"p"},"lodash")," 一同打包到库中，因此应该将其安装为 ",(0,t.kt)("inlineCode",{parentName:"p"},"devDependencies")," 而非 ",(0,t.kt)("inlineCode",{parentName:"p"},"dependencies"),"，否则库体积会变得很大。"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"src/ref.json")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-json",parentName:"pre"},(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token property",parentName:"code"},'"num"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"1"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token property",parentName:"code"},'"word"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"One"'),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token property",parentName:"code"},'"num"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"2"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token property",parentName:"code"},'"word"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"Two"'),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token property",parentName:"code"},'"num"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"3"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token property",parentName:"code"},'"word"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"Three"'),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token property",parentName:"code"},'"num"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"4"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token property",parentName:"code"},'"word"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"Four"'),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token property",parentName:"code"},'"num"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"5"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token property",parentName:"code"},'"word"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"Five"'),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token property",parentName:"code"},'"num"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"0"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token property",parentName:"code"},'"word"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"Zero"'),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"))),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"src/index.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"import")," _ ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'lodash'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"import")," numRef ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'./ref.json'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"export")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"function")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"numToWord"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"num"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return")," _",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"reduce"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"\n    numRef",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"accum",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},",")," ref"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return")," ref",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"num ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"===")," num ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"?")," ref",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"word ",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," accum",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token string",parentName:"code"},"''"),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"export")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"function")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"wordToNum"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"word"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return")," _",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"reduce"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"\n    numRef",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"accum",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},",")," ref"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return")," ref",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"word ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"===")," word ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"&&")," word",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"toLowerCase"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"?")," ref",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"num ",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," accum",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"-"),(0,t.kt)("span",{className:"token number",parentName:"code"},"1"),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"webpack-configuration",parentName:"h2"}),"webpack 配置",(0,t.kt)("a",{href:"#webpack-configuration","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"从如下 webpack 基本配置开始："),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"webpack.config.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," path ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'path'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\nmodule",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"exports ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  entry",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'./src/index.js'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  output",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    path",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," path",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"resolve"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"__dirname",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'dist'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    filename",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'webpack-numbers.js'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("p",null,"上述配置告诉 webpack 将 ",(0,t.kt)("inlineCode",{parentName:"p"},"src/index.js")," 打包到 ",(0,t.kt)("inlineCode",{parentName:"p"},"dist/webpack-numbers.js")," 中。"),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"expose-the-library",parentName:"h2"}),"暴露库",(0,t.kt)("a",{href:"#expose-the-library","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"到目前为止，一切都应该与打包应用程序一样，但是打包库有一个不同的地方——需要通过 ",(0,t.kt)("a",{href:"/configuration/output/#outputlibrary",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"output.library"))," 配置项暴露从入口起点导出的内容。"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"webpack.config.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-diff",parentName:"pre"},(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"}," const path = require('path');\n")),"\n",(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"}," module.exports = {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"   entry: './src/index.js',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"   output: {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"     path: path.resolve(__dirname, 'dist'),\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"     filename: 'webpack-numbers.js',\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},'     library: "webpackNumbers",\n')),(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"   },\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"}," };")))),(0,t.kt)("p",null,"我们将入口暴露为 ",(0,t.kt)("inlineCode",{parentName:"p"},"webpackNumbers"),"，这样用户就可以通过脚本标签使用它："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-html",parentName:"pre"},(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"<"),"script")," ",(0,t.kt)("span",{className:"token attr-name",parentName:"span"},"src"),(0,t.kt)("span",{className:"token attr-value",parentName:"span"},(0,t.kt)("span",{className:"token punctuation attr-equals",parentName:"span"},"="),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'),"https://example.org/webpack-numbers.js",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"')),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),(0,t.kt)("span",{className:"token script",parentName:"code"}),(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"</"),"script"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),"\n",(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"<"),"script"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),(0,t.kt)("span",{className:"token script",parentName:"code"},(0,t.kt)("span",{className:"token language-javascript",parentName:"span"},"\n  window",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"webpackNumbers",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),(0,t.kt)("span",{className:"token function",parentName:"span"},"wordToNum"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"("),(0,t.kt)("span",{className:"token string",parentName:"span"},"'Five'"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},";"),"\n")),(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"</"),"script"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")))),(0,t.kt)("p",null,"然而它只能通过被脚本标签引用而发挥作用，而不能运行在 CommonJS、AMD、Node.js 等环境中。"),(0,t.kt)("p",null,"作为一个库作者，我们希望它能够兼容不同的环境。换言之，用户应该能够通过以下方式使用打包后的库："),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("strong",{parentName:"p"},"在 CommonJS 模块中导入"),"："),(0,t.kt)("pre",{parentName:"li"},(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"const")," webpackNumbers ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'webpack-numbers'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ……"),"\nwebpackNumbers",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"wordToNum"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'Two'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";")))),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("strong",{parentName:"p"},"在 AMD 模块中导入"),"："),(0,t.kt)("pre",{parentName:"li"},(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token function",parentName:"code"},"require"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.kt)("span",{className:"token string",parentName:"code"},"'webpackNumbers'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"function")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"webpackNumbers"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ……"),"\n  webpackNumbers",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"wordToNum"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'Two'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";")))),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("strong",{parentName:"p"},"使用脚本标签"),"："),(0,t.kt)("pre",{parentName:"li"},(0,t.kt)("code",{className:"hljs language-html",parentName:"pre"},(0,t.kt)("span",{className:"token doctype",parentName:"code"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"<!"),(0,t.kt)("span",{className:"token doctype-tag",parentName:"span"},"DOCTYPE")," ",(0,t.kt)("span",{className:"token name",parentName:"span"},"html"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),"\n",(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"<"),"html"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),"\n  ...\n  ",(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"<"),"script")," ",(0,t.kt)("span",{className:"token attr-name",parentName:"span"},"src"),(0,t.kt)("span",{className:"token attr-value",parentName:"span"},(0,t.kt)("span",{className:"token punctuation attr-equals",parentName:"span"},"="),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'),"https://example.org/webpack-numbers.js",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"')),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),(0,t.kt)("span",{className:"token script",parentName:"code"}),(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"</"),"script"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),"\n  ",(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"<"),"script"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),(0,t.kt)("span",{className:"token script",parentName:"code"},(0,t.kt)("span",{className:"token language-javascript",parentName:"span"},"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"span"},"// ……"),"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"span"},"// 全局变量"),"\n    webpackNumbers",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),(0,t.kt)("span",{className:"token function",parentName:"span"},"wordToNum"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"("),(0,t.kt)("span",{className:"token string",parentName:"span"},"'Five'"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},";"),"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"span"},"// 属性处于 window 对象中"),"\n    window",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"webpackNumbers",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),(0,t.kt)("span",{className:"token function",parentName:"span"},"wordToNum"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"("),(0,t.kt)("span",{className:"token string",parentName:"span"},"'Five'"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},";"),"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"span"},"// ……"),"\n  ")),(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"</"),"script"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),"\n",(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"</"),"html"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")))))),(0,t.kt)("p",null,"接下来更新 ",(0,t.kt)("inlineCode",{parentName:"p"},"output.library")," 配置项，将其 ",(0,t.kt)("inlineCode",{parentName:"p"},"type")," 设置为 ",(0,t.kt)("a",{href:"/configuration/output/#type-umd",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"'umd'")),"："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-diff",parentName:"pre"},(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"const path = require('path');\n")),"\n",(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"module.exports = {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  entry: './src/index.js',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  output: {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"    path: path.resolve(__dirname, 'dist'),\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"    filename: 'webpack-numbers.js',\n")),(0,t.kt)("span",{className:"token deleted-sign deleted",parentName:"code"},(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    library: 'webpackNumbers',\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    library: {\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"      name: 'webpackNumbers',\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"      type: 'umd',\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    },\n")),(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  },\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"};")))),(0,t.kt)("p",null,"现在 webpack 将打包它，使其可以通过 CommonJS、AMD 模块以及脚本标签使用。"),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"提示"),(0,t.kt)("p",{parentName:"aside"},"请注意，",(0,t.kt)("inlineCode",{parentName:"p"},"library")," 选项与 ",(0,t.kt)("inlineCode",{parentName:"p"},"entry")," 配置项绑定。对于绝大多数的库，指定一个入口就已经足够了。尽管可能存在 ",(0,t.kt)("a",{href:"https://github.com/webpack/webpack/tree/master/examples/multi-part-library",parentName:"p"},"multi-part library"),"，但通过作为单个入口起点的 ",(0,t.kt)("a",{href:"https://stackoverflow.com/questions/34072598/es6-exporting-importing-in-index-file",parentName:"p"},"index 脚本")," 暴露部分导出会更简单。",(0,t.kt)("strong",{parentName:"p"},"不推荐")," 使用数组作为 ",(0,t.kt)("inlineCode",{parentName:"p"},"entry"),"。")),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"externalize-lodash",parentName:"h2"}),"外部化 lodash",(0,t.kt)("a",{href:"#externalize-lodash","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"现在，如果执行 ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack"),"，你会发现创建了一个体积相当大的文件。查看文件可以发现 lodash 也被打包到代码中。在这种场景中，我们更倾向于把 ",(0,t.kt)("inlineCode",{parentName:"p"},"lodash")," 当作 ",(0,t.kt)("inlineCode",{parentName:"p"},"peerDependency"),"，即使用者应该已经自行安装过 ",(0,t.kt)("inlineCode",{parentName:"p"},"lodash"),"，这样便可以放弃控制此外部库，将控制权让给使用此库的开发者。"),(0,t.kt)("p",null,"使用 ",(0,t.kt)("inlineCode",{parentName:"p"},"externals")," 配置即可实现上述目标："),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"webpack.config.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-diff",parentName:"pre"},(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"}," const path = require('path');\n")),"\n",(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"}," module.exports = {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"   entry: './src/index.js',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"   output: {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"     path: path.resolve(__dirname, 'dist'),\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"     filename: 'webpack-numbers.js',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"     library: {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},'       name: "webpackNumbers",\n'),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},'       type: "umd"\n'),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"     },\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"   },\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"   externals: {\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"     lodash: {\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"       commonjs: 'lodash',\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"       commonjs2: 'lodash',\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"       amd: 'lodash',\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"       root: '_',\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"     },\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"   },\n")),(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"}," };")))),(0,t.kt)("p",null,"上面的配置意味着这个库需要一个名为 ",(0,t.kt)("inlineCode",{parentName:"p"},"lodash")," 的依赖，这个依赖在开发者环境中必须存在且可用。"),(0,t.kt)("h3",null,(0,t.kt)("span",{id:"external-limitations",parentName:"h3"}),"外部化的限制",(0,t.kt)("a",{href:"#external-limitations","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"对于想要实现从一个依赖中调用多个文件的那些库："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"import")," ",(0,t.kt)("span",{className:"token constant",parentName:"code"},"A")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'library/one'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"import")," ",(0,t.kt)("span",{className:"token constant",parentName:"code"},"B")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'library/two'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// ..."))),(0,t.kt)("p",null,"无法通过在 ",(0,t.kt)("inlineCode",{parentName:"p"},"externals")," 中指定整个 ",(0,t.kt)("inlineCode",{parentName:"p"},"library")," 的方式将它们从 bundle 中排除，而是需要逐个或者使用正则表达式排除它们。"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},"module",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"exports ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"//..."),"\n  externals",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n    ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'library/one'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'library/two'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"code"},'// 匹配以 "library/" 开始的所有依赖'),"\n    ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"/"),(0,t.kt)("span",{className:"token operator",parentName:"code"},"^"),"library\\",(0,t.kt)("span",{className:"token regex",parentName:"code"},"/.+$/"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h2",null,(0,t.kt)("span",{id:"final-steps",parentName:"h2"}),"最终步骤",(0,t.kt)("a",{href:"#final-steps","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"遵循 ",(0,t.kt)("a",{href:"/guides/production",parentName:"p"},"生产环境")," 指南中提到的步骤优化生产环境下的输出结果。那么此时还需要生成 bundle 的文件路径，并将其添加到 ",(0,t.kt)("inlineCode",{parentName:"p"},"package.json")," 中的 ",(0,t.kt)("inlineCode",{parentName:"p"},"main")," 字段中。"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"package.json")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-json",parentName:"pre"},(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ...\n  ",(0,t.kt)("span",{className:"token property",parentName:"code"},'"main"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"dist/webpack-numbers.js"'),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ...\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,t.kt)("p",null,"或者也可以按照这个 ",(0,t.kt)("a",{href:"https://github.com/dherman/defense-of-dot-js/blob/master/proposal.md#typical-usage",parentName:"p"},"指南")," 将其添加为标准模块："),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-json",parentName:"pre"},(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ...\n  ",(0,t.kt)("span",{className:"token property",parentName:"code"},'"module"'),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"src/index.js"'),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ...\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,t.kt)("p",null,"此处的键 ",(0,t.kt)("inlineCode",{parentName:"p"},"main")," 是参照 ",(0,t.kt)("a",{href:"https://docs.npmjs.com/files/package.json#main",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"package.json")," 标准"),"，而 ",(0,t.kt)("inlineCode",{parentName:"p"},"module")," 是参照 ",(0,t.kt)("a",{href:"https://github.com/dherman/defense-of-dot-js/blob/master/proposal.md",parentName:"p"},"这个")," ",(0,t.kt)("a",{href:"https://github.com/rollup/rollup/wiki/pkg.module",parentName:"p"},"提案"),"，此提案允许 JavaScript 生态系统升级使用 ES2015 模块，而不会破坏向后兼容性。"),(0,t.kt)("aside",{className:"warning"},(0,t.kt)("h6",{className:"warning__prefix",parentName:"aside"},"警告"),(0,t.kt)("p",{parentName:"aside"},(0,t.kt)("inlineCode",{parentName:"p"},"module")," 属性应指向一个使用 ES2015 模块语法的脚本，但不包括浏览器或 Node.js 尚不支持的其他语法特性。这使得 webpack 本身就可以解析模块语法，如果用户只用到库的某些部分，则允许通过 ",(0,t.kt)("a",{href:"https://webpack.docschina.org/guides/tree-shaking/",parentName:"p"},"tree shaking")," 打包更轻量的包。")),(0,t.kt)("p",null,"现在便可以 ",(0,t.kt)("a",{href:"https://docs.npmjs.com/getting-started/publishing-npm-packages",parentName:"p"},"将其发布为一个 npm 包"),"，并且在 ",(0,t.kt)("a",{href:"https://unpkg.com/#/",parentName:"p"},"unpkg.com")," 找到它，并分发给用户。"),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"提示"),(0,t.kt)("p",{parentName:"aside"},"建议使用 ",(0,t.kt)("a",{href:"/plugins/mini-css-extract-plugin",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"MiniCssExtractPlugin"))," 暴露与库关联的样式表，然后用户可以像使用其他样式表一样使用和加载这些样式表。")))}o.isMDXComponent=!0,e.default=o}}]);